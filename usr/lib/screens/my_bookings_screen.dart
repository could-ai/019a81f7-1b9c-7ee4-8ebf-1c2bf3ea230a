import 'package:flutter/material.dart';\nimport '../models/booking.dart';\nimport '../services/hotel_service.dart';\nimport '../widgets/booking_card.dart';\n\nclass MyBookingsScreen extends StatefulWidget {\n  const MyBookingsScreen({super.key});\n\n  @override\n  State<MyBookingsScreen> createState() => _MyBookingsScreenState();\n}\n\nclass _MyBookingsScreenState extends State<MyBookingsScreen> {\n  final HotelService _hotelService = HotelService();\n  List<Booking> _bookings = [];\n  bool _isLoading = true;\n\n  @override\n  void initState() {\n    super.initState();\n    _loadBookings();\n  }\n\n  Future<void> _loadBookings() async {\n    setState(() => _isLoading = true);\n    try {\n      final bookings = await _hotelService.getAllBookings();\n      setState(() {\n        _bookings = bookings;\n        _isLoading = false;\n      });\n    } catch (e) {\n      setState(() => _isLoading = false);\n      if (mounted) {\n        ScaffoldMessenger.of(context).showSnackBar(\n          SnackBar(content: Text('Error loading bookings: $e')),\n        );\n      }\n    }\n  }\n\n  Future<void> _cancelBooking(String bookingId) async {\n    final confirm = await showDialog<bool>(\n      context: context,\n      builder: (context) => AlertDialog(\n        title: const Text('Cancel Booking'),\n        content: const Text('Are you sure you want to cancel this booking?'),\n        actions: [\n          TextButton(\n            onPressed: () => Navigator.pop(context, false),\n            child: const Text('No'),\n          ),\n          ElevatedButton(\n            onPressed: () => Navigator.pop(context, true),\n            style: ElevatedButton.styleFrom(\n              backgroundColor: Colors.red,\n              foregroundColor: Colors.white,\n            ),\n            child: const Text('Yes, Cancel'),\n          ),\n        ],\n      ),\n    );\n\n    if (confirm == true) {\n      try {\n        final success = await _hotelService.cancelBooking(bookingId);\n        if (success) {\n          if (mounted) {\n            ScaffoldMessenger.of(context).showSnackBar(\n              const SnackBar(content: Text('Booking cancelled successfully')),\n            );\n          }\n          _loadBookings();\n        }\n      } catch (e) {\n        if (mounted) {\n          ScaffoldMessenger.of(context).showSnackBar(\n            SnackBar(content: Text('Error cancelling booking: $e')),\n          );\n        }\n      }\n    }\n  }\n\n  @override\n  Widget build(BuildContext context) {\n    return Scaffold(\n      appBar: AppBar(\n        title: const Text('My Bookings'),\n        backgroundColor: Theme.of(context).colorScheme.primary,\n        foregroundColor: Colors.white,\n      ),\n      body: _isLoading\n          ? const Center(child: CircularProgressIndicator())\n          : _bookings.isEmpty\n              ? Center(\n                  child: Column(\n                    mainAxisAlignment: MainAxisAlignment.center,\n                    children: [\n                      Icon(\n                        Icons.book_outlined,\n                        size: 64,\n                        color: Colors.grey[400],\n                      ),\n                      const SizedBox(height: 16),\n                      Text(\n                        'No bookings yet',\n                        style: TextStyle(\n                          fontSize: 18,\n                          color: Colors.grey[600],\n                        ),\n                      ),\n                      const SizedBox(height: 8),\n                      Text(\n                        'Start exploring hotels to make your first booking!',\n                        style: TextStyle(\n                          fontSize: 14,\n                          color: Colors.grey[500],\n                        ),\n                      ),\n                      const SizedBox(height: 24),\n                      ElevatedButton(\n                        onPressed: () => Navigator.pop(context),\n                        style: ElevatedButton.styleFrom(\n                          backgroundColor: Theme.of(context).colorScheme.primary,\n                          foregroundColor: Colors.white,\n                        ),\n                        child: const Text('Browse Hotels'),\n                      ),\n                    ],\n                  ),\n                )\n              : RefreshIndicator(\n                  onRefresh: _loadBookings,\n                  child: ListView.builder(\n                    padding: const EdgeInsets.all(16),\n                    itemCount: _bookings.length,\n                    itemBuilder: (context, index) {\n                      return BookingCard(\n                        booking: _bookings[index],\n                        onCancel: () => _cancelBooking(_bookings[index].id),\n                      );\n                    },\n                  ),\n                ),\n    );\n  }\n}\n