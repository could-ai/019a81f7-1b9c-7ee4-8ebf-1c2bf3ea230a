import 'package:flutter/material.dart';\nimport '../models/hotel.dart';\nimport '../services/hotel_service.dart';\nimport '../widgets/hotel_card.dart';\n\nclass HomeScreen extends StatefulWidget {\n  const HomeScreen({super.key});\n\n  @override\n  State<HomeScreen> createState() => _HomeScreenState();\n}\n\nclass _HomeScreenState extends State<HomeScreen> {\n  final HotelService _hotelService = HotelService();\n  final TextEditingController _searchController = TextEditingController();\n  List<Hotel> _hotels = [];\n  List<Hotel> _filteredHotels = [];\n  bool _isLoading = true;\n  int _selectedIndex = 0;\n\n  @override\n  void initState() {\n    super.initState();\n    _loadHotels();\n  }\n\n  Future<void> _loadHotels() async {\n    setState(() => _isLoading = true);\n    try {\n      final hotels = await _hotelService.getAllHotels();\n      setState(() {\n        _hotels = hotels;\n        _filteredHotels = hotels;\n        _isLoading = false;\n      });\n    } catch (e) {\n      setState(() => _isLoading = false);\n      if (mounted) {\n        ScaffoldMessenger.of(context).showSnackBar(\n          SnackBar(content: Text('Error loading hotels: $e')),\n        );\n      }\n    }\n  }\n\n  void _searchHotels(String query) async {\n    if (query.isEmpty) {\n      setState(() => _filteredHotels = _hotels);\n      return;\n    }\n    \n    try {\n      final results = await _hotelService.searchHotels(query);\n      setState(() => _filteredHotels = results);\n    } catch (e) {\n      if (mounted) {\n        ScaffoldMessenger.of(context).showSnackBar(\n          SnackBar(content: Text('Error searching: $e')),\n        );\n      }\n    }\n  }\n\n  void _onBottomNavTap(int index) {\n    setState(() => _selectedIndex = index);\n    if (index == 1) {\n      Navigator.pushNamed(context, '/my-bookings');\n      // Reset to home after navigation\n      Future.delayed(const Duration(milliseconds: 100), () {\n        if (mounted) setState(() => _selectedIndex = 0);\n      });\n    }\n  }\n\n  @override\n  Widget build(BuildContext context) {\n    return Scaffold(\n      appBar: AppBar(\n        title: const Text('Hotel Booking'),\n        backgroundColor: Theme.of(context).colorScheme.primary,\n        foregroundColor: Colors.white,\n      ),\n      body: Column(\n        children: [\n          // Search bar\n          Container(\n            padding: const EdgeInsets.all(16),\n            color: Theme.of(context).colorScheme.primary.withOpacity(0.1),\n            child: TextField(\n              controller: _searchController,\n              decoration: InputDecoration(\n                hintText: 'Search hotels or locations...',\n                prefixIcon: const Icon(Icons.search),\n                suffixIcon: _searchController.text.isNotEmpty\n                    ? IconButton(\n                        icon: const Icon(Icons.clear),\n                        onPressed: () {\n                          _searchController.clear();\n                          _searchHotels('');\n                        },\n                      )\n                    : null,\n                filled: true,\n                fillColor: Colors.white,\n                border: OutlineInputBorder(\n                  borderRadius: BorderRadius.circular(12),\n                  borderSide: BorderSide.none,\n                ),\n              ),\n              onChanged: _searchHotels,\n            ),\n          ),\n          // Hotels list\n          Expanded(\n            child: _isLoading\n                ? const Center(child: CircularProgressIndicator())\n                : _filteredHotels.isEmpty\n                    ? Center(\n                        child: Column(\n                          mainAxisAlignment: MainAxisAlignment.center,\n                          children: [\n                            Icon(\n                              Icons.hotel_outlined,\n                              size: 64,\n                              color: Colors.grey[400],\n                            ),\n                            const SizedBox(height: 16),\n                            Text(\n                              'No hotels found',\n                              style: TextStyle(\n                                fontSize: 18,\n                                color: Colors.grey[600],\n                              ),\n                            ),\n                          ],\n                        ),\n                      )\n                    : RefreshIndicator(\n                        onRefresh: _loadHotels,\n                        child: ListView.builder(\n                          padding: const EdgeInsets.all(16),\n                          itemCount: _filteredHotels.length,\n                          itemBuilder: (context, index) {\n                            return HotelCard(\n                              hotel: _filteredHotels[index],\n                              onTap: () {\n                                Navigator.pushNamed(\n                                  context,\n                                  '/hotel-details',\n                                  arguments: _filteredHotels[index],\n                                );\n                              },\n                            );\n                          },\n                        ),\n                      ),\n          ),\n        ],\n      ),\n      bottomNavigationBar: BottomNavigationBar(\n        currentIndex: _selectedIndex,\n        onTap: _onBottomNavTap,\n        items: const [\n          BottomNavigationBarItem(\n            icon: Icon(Icons.home),\n            label: 'Home',\n          ),\n          BottomNavigationBarItem(\n            icon: Icon(Icons.book),\n            label: 'My Bookings',\n          ),\n        ],\n      ),\n    );\n  }\n\n  @override\n  void dispose() {\n    _searchController.dispose();\n    super.dispose();\n  }\n}\n